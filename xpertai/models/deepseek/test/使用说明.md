# æµ‹è¯•ä½¿ç”¨è¯´æ˜

## ğŸ“‹ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šé…ç½® API Key

1. **æ‰“å¼€é…ç½®æ–‡ä»¶**
   ```
   test/config.ts
   ```

2. **å¡«å…¥ä½ çš„ DeepSeek API Key**
   ```typescript
   export const testConfig = {
     apiKey: 'sk-xxxxxxxxxxxxx', // ğŸ‘ˆ åœ¨è¿™é‡Œå¡«å…¥ä½ çš„ API Key
     baseURL: 'https://api.deepseek.com/v1',
     timeout: 30000,
   };
   ```

3. **è·å– API Key**
   - è®¿é—®ï¼šhttps://platform.deepseek.com/api_keys
   - ç™»å½•ååˆ›å»ºæˆ–å¤åˆ¶ä½ çš„ API Key

### ç¬¬äºŒæ­¥ï¼šè¿è¡Œæµ‹è¯•

#### æ–¹æ³• 1: ç®€å•æµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# ä» deepseek æ’ä»¶ç›®å½•è¿è¡Œ
npx tsx test/test-developer-role-fix-simple.ts
```

#### æ–¹æ³• 2: Jest å•å…ƒæµ‹è¯•

```bash
# ä» xpertai ç›®å½•è¿è¡Œ
npx nx test @cry0100/plugin-deepseek --testPathPattern=test-developer-role-fix
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
test/
â”œâ”€â”€ config.ts                    # é…ç½®æ–‡ä»¶ï¼ˆå¡«å…¥ API Keyï¼Œä¸æäº¤åˆ° Gitï¼‰
â”œâ”€â”€ config.example.ts            # é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼ˆå¯ä»¥æäº¤ï¼‰
â”œâ”€â”€ test-developer-role-fix-simple.ts  # ç®€å•æµ‹è¯•è„šæœ¬
â”œâ”€â”€ test-developer-role-fix.test.ts    # Jest å•å…ƒæµ‹è¯•
â”œâ”€â”€ README.md                    # è¯¦ç»†è¯´æ˜
â””â”€â”€ .gitignore                   # å¿½ç•¥ config.ts
```

## âœ… æµ‹è¯•å†…å®¹

æµ‹è¯•ä¼šéªŒè¯ï¼š

1. **System Message å¤„ç†**
   - ä½¿ç”¨ `deepseek-reasoner` æ¨¡å‹
   - å‘é€åŒ…å« `system` message çš„è¯·æ±‚
   - éªŒè¯ä¸ä¼šå‡ºç° `developer` role é”™è¯¯

2. **å¤šè½®å¯¹è¯**
   - æµ‹è¯•åŒ…å« `reasoning_content` çš„å¤šè½®å¯¹è¯
   - éªŒè¯ `reasoning_content` æ­£ç¡®ä¼ é€’

3. **æµå¼å“åº”**
   - æµ‹è¯•æµå¼å“åº”æ˜¯å¦æ­£å¸¸å·¥ä½œ

## ğŸ¯ é¢„æœŸç»“æœ

### âœ… æˆåŠŸ

```
ğŸ§ª å¼€å§‹æµ‹è¯• deepseek-reasoner æ¨¡å‹...

ğŸ“¤ å‘é€è¯·æ±‚ï¼š
   Model: deepseek-reasoner
   Messages: [...]

â³ ç­‰å¾… API å“åº”...

âœ… æµ‹è¯•æˆåŠŸï¼
ğŸ“¥ å“åº”å†…å®¹ï¼š
   [æ¨¡å‹çš„å®é™…å“åº”]

âœ… æ²¡æœ‰å‡ºç° developer role é”™è¯¯ï¼ä¿®å¤æˆåŠŸï¼
```

### âŒ å¤±è´¥

å¦‚æœä»ç„¶æŠ¥é”™ï¼š
```
âŒ æµ‹è¯•å¤±è´¥ï¼
   é”™è¯¯ä¿¡æ¯: 400 Failed to deserialize the JSON body into the target type: messages[0].role: unknown variant `developer`...

âŒ ä»ç„¶å‡ºç° developer role é”™è¯¯ï¼
```

## ğŸ”’ å®‰å…¨æç¤º

- âœ… `config.ts` å·²åœ¨ `.gitignore` ä¸­ï¼Œä¸ä¼šè¢«æäº¤åˆ° Git
- âœ… ä¸è¦å°†åŒ…å«çœŸå® API Key çš„æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- âœ… å¦‚æœ `config.ts` è¢«æ„å¤–æäº¤ï¼Œè¯·ç«‹å³æ’¤é”€å¹¶æ›´æ–° API Key

## ğŸ› å¸¸è§é—®é¢˜

### Q: æ‰¾ä¸åˆ° config.ts

**A**: å¦‚æœ `config.ts` ä¸å­˜åœ¨ï¼Œä»ç¤ºä¾‹æ–‡ä»¶å¤åˆ¶ï¼š
```bash
cd test
cp config.example.ts config.ts
# ç„¶åç¼–è¾‘ config.ts å¡«å…¥ API Key
```

### Q: API Key æ— æ•ˆ

**A**: æ£€æŸ¥ï¼š
- API Key æ˜¯å¦æ­£ç¡®å¤åˆ¶ï¼ˆæ²¡æœ‰å¤šä½™ç©ºæ ¼ï¼‰
- API Key æ˜¯å¦å·²è¿‡æœŸ
- API Key æ˜¯å¦æœ‰è¶³å¤Ÿçš„æƒé™

### Q: ä»ç„¶å‡ºç° developer role é”™è¯¯

**A**: å¯èƒ½åŸå› ï¼š
1. å¹³å°ä»åœ¨ä½¿ç”¨æ—§ç‰ˆæœ¬ä»£ç 
2. éœ€è¦æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ (0.0.4)

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
npm cache clean --force
npm uninstall @cry0100/plugin-deepseek
npm install @cry0100/plugin-deepseek@0.0.4
```

